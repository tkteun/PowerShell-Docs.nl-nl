---
ms.date: 09/13/2016
ms.topic: reference
title: Een eenvoudige Windows PowerShell-provider ontwerpen
description: Een eenvoudige Windows PowerShell-provider ontwerpen
ms.openlocfilehash: 03b5784fd063b5457fc64d92a32e286e3bf9cce4
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 12/10/2020
ms.locfileid: "92647514"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="fde66-103">Een eenvoudige Windows PowerShell-provider ontwerpen</span><span class="sxs-lookup"><span data-stu-id="fde66-103">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="fde66-104">Dit onderwerp is het begin punt voor het leren van het maken van een Windows Power shell-provider.</span><span class="sxs-lookup"><span data-stu-id="fde66-104">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="fde66-105">De hier beschreven basis provider biedt methoden voor het starten en stoppen van de provider, maar deze provider biedt geen manier om toegang te krijgen tot een gegevens archief of om gegevens op te halen of in te stellen in het gegevens archief, maar biedt de basis functionaliteit die is vereist voor alle providers.</span><span class="sxs-lookup"><span data-stu-id="fde66-105">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="fde66-106">Zoals eerder vermeld, implementeert de Basic-provider die hier wordt beschreven, methoden voor het starten en stoppen van de provider.</span><span class="sxs-lookup"><span data-stu-id="fde66-106">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="fde66-107">De Windows Power shell-runtime roept deze methoden aan om de provider te initialiseren en op te starten.</span><span class="sxs-lookup"><span data-stu-id="fde66-107">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="fde66-108">U kunt een voor beeld van deze provider vinden in het AccessDBSampleProvider01.cs-bestand van Windows Power shell.</span><span class="sxs-lookup"><span data-stu-id="fde66-108">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="fde66-109">De Windows Power shell-provider klasse definiëren</span><span class="sxs-lookup"><span data-stu-id="fde66-109">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="fde66-110">De eerste stap bij het maken van een Windows Power shell-provider is het definiëren van de .NET-klasse.</span><span class="sxs-lookup"><span data-stu-id="fde66-110">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="fde66-111">Deze basis provider definieert een klasse `AccessDBProvider` met de naam die is afgeleid van de basis klasse [System. Management. Automation. provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="fde66-111">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="fde66-112">Het is raadzaam om uw provider klassen in een `Providers` naam ruimte van uw API-naam ruimte te plaatsen, bijvoorbeeld xxx. Power shell. providers.</span><span class="sxs-lookup"><span data-stu-id="fde66-112">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="fde66-113">Deze provider maakt gebruik `Microsoft.Samples.PowerShell.Provider` van de naam ruimte, waarin alle voor beelden van Windows Power shell-providers worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="fde66-113">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="fde66-114">De klasse voor een Windows Power shell-provider moet expliciet als openbaar worden gemarkeerd.</span><span class="sxs-lookup"><span data-stu-id="fde66-114">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="fde66-115">Klassen die niet als openbaar zijn gemarkeerd, zijn standaard intern en worden niet gevonden door de Windows Power shell-runtime.</span><span class="sxs-lookup"><span data-stu-id="fde66-115">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="fde66-116">Dit is de klassedefinitie voor deze basis provider:</span><span class="sxs-lookup"><span data-stu-id="fde66-116">Here is the class definition for this basic provider:</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs" range="23-24":::

<span data-ttu-id="fde66-117">Rechts voor de klassedefinitie moet u het kenmerk [System. Management. Automation. provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) declareren met de syntaxis [CmdletProvider ()].</span><span class="sxs-lookup"><span data-stu-id="fde66-117">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="fde66-118">U kunt kenmerk trefwoorden instellen om de klasse zo nodig verder te declareren.</span><span class="sxs-lookup"><span data-stu-id="fde66-118">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="fde66-119">U ziet dat het kenmerk [System. Management. Automation. provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) dat hier is gedeclareerd, twee para meters bevat.</span><span class="sxs-lookup"><span data-stu-id="fde66-119">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="fde66-120">De eerste kenmerk parameter geeft de beschrijvende naam op voor de provider, die de gebruiker later kan wijzigen.</span><span class="sxs-lookup"><span data-stu-id="fde66-120">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="fde66-121">Met de tweede para meter geeft u de door Windows Power shell gedefinieerde mogelijkheden op die de provider beschikbaar maakt voor de Windows Power shell-runtime tijdens het verwerken van opdrachten.</span><span class="sxs-lookup"><span data-stu-id="fde66-121">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="fde66-122">De mogelijke waarden voor de provider mogelijkheden worden gedefinieerd door de inventarisatie [System. Management. Automation. provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="fde66-122">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="fde66-123">Omdat dit een basis provider is, ondersteunt deze geen mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="fde66-123">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="fde66-124">De volledig gekwalificeerde naam van de Windows Power shell-provider bevat de assembly naam en andere kenmerken die door Windows Power shell worden bepaald na registratie van de provider.</span><span class="sxs-lookup"><span data-stu-id="fde66-124">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="fde66-125">Provider-Specific status gegevens definiëren</span><span class="sxs-lookup"><span data-stu-id="fde66-125">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="fde66-126">De basis klasse [System. Management. Automation. provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) en alle afgeleide klassen worden beschouwd als stateless omdat de Windows Power shell-runtime alleen provider instanties maakt als dat nodig is.</span><span class="sxs-lookup"><span data-stu-id="fde66-126">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="fde66-127">Als uw provider echter volledig beheer en status onderhoud voor providerspecifieke gegevens vereist, moet een klasse worden afgeleid van de klasse [System. Management. Automation. Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) .</span><span class="sxs-lookup"><span data-stu-id="fde66-127">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="fde66-128">Uw afgeleide klasse moet de leden definiëren die nodig zijn om de status te behouden, zodat de providerspecifieke gegevens kunnen worden geopend wanneer de Windows Power shell-runtime de methode [System. Management. Automation. provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) aanroept om de provider te initialiseren.</span><span class="sxs-lookup"><span data-stu-id="fde66-128">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="fde66-129">Een Windows Power shell-provider kan ook de status op basis van een verbinding onderhouden.</span><span class="sxs-lookup"><span data-stu-id="fde66-129">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="fde66-130">Zie [een Power shell-schijf provider maken](./creating-a-windows-powershell-drive-provider.md)voor meer informatie over het onderhouden van de verbindings status.</span><span class="sxs-lookup"><span data-stu-id="fde66-130">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="fde66-131">De provider initialiseren</span><span class="sxs-lookup"><span data-stu-id="fde66-131">Initializing the Provider</span></span>

<span data-ttu-id="fde66-132">Voor het initialiseren van de provider roept Windows Power shell runtime de methode [System. Management. Automation. provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) aan wanneer Windows Power shell wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="fde66-132">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="fde66-133">De provider kan de standaard implementatie van deze methode echter gebruiken. dit retourneert eenvoudigweg het object [System. Management. Automation. Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) dat uw provider beschrijft.</span><span class="sxs-lookup"><span data-stu-id="fde66-133">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="fde66-134">In het geval dat u aanvullende initialisatie gegevens wilt toevoegen, moet u echter uw eigen [System. Management. Automation. provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) -methode implementeren die een gewijzigde versie retourneert van het object [System. Management. Automation. Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) dat wordt door gegeven aan uw provider.</span><span class="sxs-lookup"><span data-stu-id="fde66-134">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="fde66-135">Over het algemeen moet deze methode het opgegeven [System. Management. Automation. Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) -object retour neren dat hieraan is door gegeven of een aangepast [System. Management. Automation. Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) -object dat andere initialisatie gegevens bevat.</span><span class="sxs-lookup"><span data-stu-id="fde66-135">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="fde66-136">Deze basis provider overschrijft deze methode niet.</span><span class="sxs-lookup"><span data-stu-id="fde66-136">This basic provider does not override this method.</span></span> <span data-ttu-id="fde66-137">De volgende code toont echter de standaard implementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="fde66-137">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="fde66-138">De provider kan de status van providerspecifieke informatie onderhouden, zoals wordt beschreven in [provider-specifieke gegevens status definiëren](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="fde66-138">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="fde66-139">In dit geval moet uw implementatie de methode [System. Management. Automation. provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) overschrijven om een exemplaar van de afgeleide klasse te retour neren.</span><span class="sxs-lookup"><span data-stu-id="fde66-139">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="fde66-140">Dynamische para meters starten</span><span class="sxs-lookup"><span data-stu-id="fde66-140">Start Dynamic Parameters</span></span>

<span data-ttu-id="fde66-141">Voor de implementatie van de provider van de methode [System. Management. Automation. provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) zijn mogelijk extra para meters vereist.</span><span class="sxs-lookup"><span data-stu-id="fde66-141">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="fde66-142">In dit geval moet de provider de methode [System. Management. Automation. provider. Cmdletprovider. Startdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) overschrijven en een object retour neren met eigenschappen en velden met kenmerken die vergelijkbaar zijn met een cmdlet-klasse of een [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -object.</span><span class="sxs-lookup"><span data-stu-id="fde66-142">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="fde66-143">Deze basis provider overschrijft deze methode niet.</span><span class="sxs-lookup"><span data-stu-id="fde66-143">This basic provider does not override this method.</span></span> <span data-ttu-id="fde66-144">De volgende code toont echter de standaard implementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="fde66-144">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="fde66-145">De initialisatie van de provider ongedaan te doen</span><span class="sxs-lookup"><span data-stu-id="fde66-145">Uninitializing the Provider</span></span>

<span data-ttu-id="fde66-146">Als u resources wilt vrijmaken die worden gebruikt door de Windows Power shell-provider, moet uw provider zijn eigen [System. Management. Automation. provider. Cmdletprovider. stop \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) -methode implementeren.</span><span class="sxs-lookup"><span data-stu-id="fde66-146">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="fde66-147">Deze methode wordt aangeroepen door de Windows Power shell-runtime om de initialisatie van de provider bij het sluiten van een sessie ongedaan te maakt.</span><span class="sxs-lookup"><span data-stu-id="fde66-147">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="fde66-148">Deze basis provider overschrijft deze methode niet.</span><span class="sxs-lookup"><span data-stu-id="fde66-148">This basic provider does not override this method.</span></span> <span data-ttu-id="fde66-149">De volgende code toont echter de standaard implementatie van deze methode:</span><span class="sxs-lookup"><span data-stu-id="fde66-149">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="fde66-150">Code voorbeeld</span><span class="sxs-lookup"><span data-stu-id="fde66-150">Code Sample</span></span>

<span data-ttu-id="fde66-151">Zie [AccessDbProviderSample01 code sample](./accessdbprovidersample01-code-sample.md)voor een volledige voorbeeld code.</span><span class="sxs-lookup"><span data-stu-id="fde66-151">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="fde66-152">De Windows Power shell-provider testen</span><span class="sxs-lookup"><span data-stu-id="fde66-152">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="fde66-153">Als uw Windows Power shell-provider is geregistreerd bij Windows Power shell, kunt u deze testen door de ondersteunde cmdlets uit te voeren op de opdracht regel.</span><span class="sxs-lookup"><span data-stu-id="fde66-153">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="fde66-154">Voor deze Basic-provider voert u de nieuwe shell uit en gebruikt `Get-PSProvider` u de cmdlet om de lijst met providers op te halen en ervoor te zorgen dat de AccessDb-provider aanwezig is.</span><span class="sxs-lookup"><span data-stu-id="fde66-154">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="fde66-155">De volgende uitvoer wordt weergegeven:</span><span class="sxs-lookup"><span data-stu-id="fde66-155">The following output appears:</span></span>

```Output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="fde66-156">Zie ook</span><span class="sxs-lookup"><span data-stu-id="fde66-156">See Also</span></span>

[<span data-ttu-id="fde66-157">Windows Power shell-providers maken</span><span class="sxs-lookup"><span data-stu-id="fde66-157">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="fde66-158">Uw Windows PowerShell-provider ontwerpen</span><span class="sxs-lookup"><span data-stu-id="fde66-158">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)
