---
title: Creating a Windows PowerShell Property Provider | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: 9197f5635528e0f52cd08adde1c6bd69467725e8
ms.sourcegitcommit: d43f66071f1f33b350d34fa1f46f3a35910c5d24
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 11/23/2019
ms.locfileid: "74417480"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="473ec-102">Een Windows PowerShell-eigenschapsprovider maken</span><span class="sxs-lookup"><span data-stu-id="473ec-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="473ec-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span><span class="sxs-lookup"><span data-stu-id="473ec-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="473ec-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span><span class="sxs-lookup"><span data-stu-id="473ec-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="473ec-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span><span class="sxs-lookup"><span data-stu-id="473ec-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="473ec-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span><span class="sxs-lookup"><span data-stu-id="473ec-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="473ec-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span><span class="sxs-lookup"><span data-stu-id="473ec-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="473ec-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="473ec-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="473ec-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="473ec-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="473ec-110">The downloaded template is available in the **\<PowerShell Samples>** directory.</span><span class="sxs-lookup"><span data-stu-id="473ec-110">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="473ec-111">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span><span class="sxs-lookup"><span data-stu-id="473ec-111">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="473ec-112">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="473ec-112">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="473ec-113">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-113">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="473ec-114">Defining the Windows PowerShell provider</span><span class="sxs-lookup"><span data-stu-id="473ec-114">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="473ec-115">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span><span class="sxs-lookup"><span data-stu-id="473ec-115">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="473ec-116">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-116">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="473ec-117">Defining Base Functionality</span><span class="sxs-lookup"><span data-stu-id="473ec-117">Defining Base Functionality</span></span>

<span data-ttu-id="473ec-118">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span><span class="sxs-lookup"><span data-stu-id="473ec-118">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="473ec-119">Add the base functionality that is required by the base class you are using.</span><span class="sxs-lookup"><span data-stu-id="473ec-119">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="473ec-120">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="473ec-120">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="473ec-121">Retrieving Properties</span><span class="sxs-lookup"><span data-stu-id="473ec-121">Retrieving Properties</span></span>

<span data-ttu-id="473ec-122">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="473ec-122">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="473ec-123">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span><span class="sxs-lookup"><span data-stu-id="473ec-123">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="473ec-124">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span><span class="sxs-lookup"><span data-stu-id="473ec-124">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="473ec-125">If this parameter is `null` or empty, the method should retrieve all properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-125">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="473ec-126">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-126">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="473ec-127">The method should return nothing.</span><span class="sxs-lookup"><span data-stu-id="473ec-127">The method should return nothing.</span></span>

<span data-ttu-id="473ec-128">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span><span class="sxs-lookup"><span data-stu-id="473ec-128">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="473ec-129">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span><span class="sxs-lookup"><span data-stu-id="473ec-129">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="473ec-130">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-130">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="473ec-131">Things to Remember About Implementing GetProperty</span><span class="sxs-lookup"><span data-stu-id="473ec-131">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="473ec-132">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="473ec-132">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="473ec-133">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span><span class="sxs-lookup"><span data-stu-id="473ec-133">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="473ec-134">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span><span class="sxs-lookup"><span data-stu-id="473ec-134">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="473ec-135">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-135">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="473ec-136">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span><span class="sxs-lookup"><span data-stu-id="473ec-136">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="473ec-137">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span><span class="sxs-lookup"><span data-stu-id="473ec-137">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="473ec-138">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="473ec-138">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="473ec-139">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span><span class="sxs-lookup"><span data-stu-id="473ec-139">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="473ec-140">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-140">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="473ec-141">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span><span class="sxs-lookup"><span data-stu-id="473ec-141">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="473ec-142">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span><span class="sxs-lookup"><span data-stu-id="473ec-142">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="473ec-143">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="473ec-143">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="473ec-144">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span><span class="sxs-lookup"><span data-stu-id="473ec-144">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="473ec-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="473ec-146">Setting Properties</span><span class="sxs-lookup"><span data-stu-id="473ec-146">Setting Properties</span></span>

<span data-ttu-id="473ec-147">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="473ec-147">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="473ec-148">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span><span class="sxs-lookup"><span data-stu-id="473ec-148">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="473ec-149">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-149">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="473ec-150">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-150">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="473ec-151">Things to Remember About Implementing Set-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="473ec-151">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="473ec-152">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="473ec-152">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="473ec-153">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span><span class="sxs-lookup"><span data-stu-id="473ec-153">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="473ec-154">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span><span class="sxs-lookup"><span data-stu-id="473ec-154">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="473ec-155">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-155">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="473ec-156">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span><span class="sxs-lookup"><span data-stu-id="473ec-156">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="473ec-157">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span><span class="sxs-lookup"><span data-stu-id="473ec-157">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="473ec-158">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span><span class="sxs-lookup"><span data-stu-id="473ec-158">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="473ec-159">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span><span class="sxs-lookup"><span data-stu-id="473ec-159">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="473ec-160">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span><span class="sxs-lookup"><span data-stu-id="473ec-160">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="473ec-161">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-161">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="473ec-162">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span><span class="sxs-lookup"><span data-stu-id="473ec-162">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="473ec-163">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="473ec-163">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="473ec-164">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span><span class="sxs-lookup"><span data-stu-id="473ec-164">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="473ec-165">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-165">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="473ec-166">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="473ec-166">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="473ec-167">The `null` value can be returned if no dynamic parameters are to be added.</span><span class="sxs-lookup"><span data-stu-id="473ec-167">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="473ec-168">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-168">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="473ec-169">Clearing Properties</span><span class="sxs-lookup"><span data-stu-id="473ec-169">Clearing Properties</span></span>

<span data-ttu-id="473ec-170">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="473ec-170">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="473ec-171">This method sets one or more properties for the item located at the specified path.</span><span class="sxs-lookup"><span data-stu-id="473ec-171">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="473ec-172">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-172">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="473ec-173">Thing to Remember About Implementing ClearProperty</span><span class="sxs-lookup"><span data-stu-id="473ec-173">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="473ec-174">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="473ec-174">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="473ec-175">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span><span class="sxs-lookup"><span data-stu-id="473ec-175">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="473ec-176">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span><span class="sxs-lookup"><span data-stu-id="473ec-176">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="473ec-177">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span><span class="sxs-lookup"><span data-stu-id="473ec-177">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="473ec-178">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span><span class="sxs-lookup"><span data-stu-id="473ec-178">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="473ec-179">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span><span class="sxs-lookup"><span data-stu-id="473ec-179">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="473ec-180">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span><span class="sxs-lookup"><span data-stu-id="473ec-180">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="473ec-181">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span><span class="sxs-lookup"><span data-stu-id="473ec-181">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="473ec-182">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span><span class="sxs-lookup"><span data-stu-id="473ec-182">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="473ec-183">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-183">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="473ec-184">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span><span class="sxs-lookup"><span data-stu-id="473ec-184">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="473ec-185">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="473ec-185">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="473ec-186">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span><span class="sxs-lookup"><span data-stu-id="473ec-186">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="473ec-187">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span><span class="sxs-lookup"><span data-stu-id="473ec-187">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="473ec-188">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span><span class="sxs-lookup"><span data-stu-id="473ec-188">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="473ec-189">The `null` value can be returned if no dynamic parameters are to be added.</span><span class="sxs-lookup"><span data-stu-id="473ec-189">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="473ec-190">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="473ec-190">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="473ec-191">Building the Windows PowerShell provider</span><span class="sxs-lookup"><span data-stu-id="473ec-191">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="473ec-192">See [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="473ec-192">See [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="473ec-193">Zie ook</span><span class="sxs-lookup"><span data-stu-id="473ec-193">See Also</span></span>

[<span data-ttu-id="473ec-194">Windows PowerShell provider</span><span class="sxs-lookup"><span data-stu-id="473ec-194">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="473ec-195">Design Your Windows PowerShell provider</span><span class="sxs-lookup"><span data-stu-id="473ec-195">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="473ec-196">Extending Object Types and Formatting</span><span class="sxs-lookup"><span data-stu-id="473ec-196">Extending Object Types and Formatting</span></span>](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="473ec-197">How to Register Cmdlets, Providers, and Host Applications</span><span class="sxs-lookup"><span data-stu-id="473ec-197">How to Register Cmdlets, Providers, and Host Applications</span></span>](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)
