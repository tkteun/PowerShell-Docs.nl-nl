---
ms.date: 02/03/2020
ms.topic: reference
title: Een PowerShell-module importeren
description: Een PowerShell-module importeren
ms.openlocfilehash: 688509c0943a9a0289e75b80543f278e16cfedfe
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 12/10/2020
ms.locfileid: "92658788"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="89004-103">Een PowerShell-module importeren</span><span class="sxs-lookup"><span data-stu-id="89004-103">Importing a PowerShell Module</span></span>

<span data-ttu-id="89004-104">Wanneer u een module op een systeem hebt geïnstalleerd, wilt u waarschijnlijk de module importeren.</span><span class="sxs-lookup"><span data-stu-id="89004-104">Once you have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="89004-105">Importeren is het proces waarmee de module wordt geladen in actief geheugen, zodat een gebruiker toegang heeft tot die module in hun Power shell-sessie.</span><span class="sxs-lookup"><span data-stu-id="89004-105">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="89004-106">In Power Shell 2,0 kunt u een nieuw geïnstalleerde Power shell-module importeren met een aanroep van de cmdlet [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="89004-106">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="89004-107">In Power Shell 3,0 kan Power shell een module impliciet importeren als een van de functies of cmdlets in de module wordt aangeroepen door een gebruiker.</span><span class="sxs-lookup"><span data-stu-id="89004-107">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="89004-108">Houd er rekening mee dat beide versies ervan uitgaan dat u de module installeert op een locatie waar Power shell deze kan vinden. Zie [een Power shell-module installeren](./installing-a-powershell-module.md)voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="89004-108">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span>
<span data-ttu-id="89004-109">U kunt een module manifest gebruiken om te beperken welke onderdelen van uw module worden geëxporteerd en u kunt para meters van de `Import-Module` aanroep gebruiken om te beperken welke onderdelen worden geïmporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-109">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="89004-110">Een Snap-In importeren (Power shell 1,0)</span><span class="sxs-lookup"><span data-stu-id="89004-110">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="89004-111">Modules zijn niet aanwezig in Power shell 1,0: in plaats daarvan moest u de modules registreren en gebruiken. Het wordt echter niet aanbevolen deze technologie op dit moment te gebruiken, omdat modules doorgaans eenvoudiger te installeren en te importeren zijn.</span><span class="sxs-lookup"><span data-stu-id="89004-111">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="89004-112">Zie [een Windows Power shell-module maken](../cmdlet/how-to-create-a-windows-powershell-snap-in.md)voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="89004-112">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="89004-113">Een module importeren met Import-Module (Power Shell 2,0)</span><span class="sxs-lookup"><span data-stu-id="89004-113">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="89004-114">Power Shell 2,0 maakt gebruik van de juiste benoemde cmdlet [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) voor het importeren van modules.</span><span class="sxs-lookup"><span data-stu-id="89004-114">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="89004-115">Wanneer deze cmdlet wordt uitgevoerd, zoekt Windows Power shell naar de opgegeven module binnen de mappen die zijn opgegeven in de `PSModulePath` variabele.</span><span class="sxs-lookup"><span data-stu-id="89004-115">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="89004-116">Wanneer de opgegeven map wordt gevonden, zoekt Windows Power shell naar bestanden in de volgende volg orde: module manifest bestanden (. psd1), script module bestanden (. psm1), binaire module bestanden (. dll).</span><span class="sxs-lookup"><span data-stu-id="89004-116">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="89004-117">Zie voor meer informatie over het toevoegen van mappen aan de zoek opdracht het installatiepad van [PSModulePath wijzigen](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="89004-117">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>
<span data-ttu-id="89004-118">De volgende code beschrijft hoe een module moet worden geïmporteerd:</span><span class="sxs-lookup"><span data-stu-id="89004-118">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="89004-119">Ervan uitgaande dat myModule zich in Power Shell bevindt `PSModulePath` , wordt myModule in het actieve geheugen geladen.</span><span class="sxs-lookup"><span data-stu-id="89004-119">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="89004-120">Als myModule zich niet op een pad bevindt `PSModulePath` , kunt u Power shell nog steeds expliciet aanwijzen waar u deze kunt vinden:</span><span class="sxs-lookup"><span data-stu-id="89004-120">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="89004-121">U kunt ook de `-Verbose` para meter gebruiken om te bepalen wat wordt geëxporteerd uit de module en wat wordt geïmporteerd in actief geheugen.</span><span class="sxs-lookup"><span data-stu-id="89004-121">You can also use the `-Verbose` parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="89004-122">Zowel de export als de invoer beperken wat er aan de gebruiker wordt blootgesteld: het verschil is wie de zicht baarheid beheert.</span><span class="sxs-lookup"><span data-stu-id="89004-122">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="89004-123">In wezen worden exports beheerd door code binnen de module.</span><span class="sxs-lookup"><span data-stu-id="89004-123">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="89004-124">De invoer wordt daarentegen bepaald door de `Import-Module` aanroep.</span><span class="sxs-lookup"><span data-stu-id="89004-124">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="89004-125">Zie voor meer informatie **het beperken van leden die hieronder worden geïmporteerd**.</span><span class="sxs-lookup"><span data-stu-id="89004-125">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="89004-126">Een module impliciet importeren (Power Shell 3,0)</span><span class="sxs-lookup"><span data-stu-id="89004-126">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="89004-127">Vanaf Windows Power Shell 3,0 worden modules automatisch geïmporteerd wanneer een cmdlet of functie in de module in een opdracht wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="89004-127">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="89004-128">Deze functie werkt voor elke module in een map die is opgenomen in de waarde van de omgevings variabele **PSModulePath** .</span><span class="sxs-lookup"><span data-stu-id="89004-128">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="89004-129">Als u de module niet opslaat op een geldig pad, kunt u deze nog steeds laden met de expliciete [import module-](/powershell/module/Microsoft.PowerShell.Core/Import-Module) optie, zoals hierboven beschreven.</span><span class="sxs-lookup"><span data-stu-id="89004-129">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="89004-130">Met de volgende acties wordt het automatisch importeren van een module geactiveerd, ook wel ' module automatisch laden ' genoemd.</span><span class="sxs-lookup"><span data-stu-id="89004-130">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="89004-131">Een cmdlet gebruiken in een opdracht.</span><span class="sxs-lookup"><span data-stu-id="89004-131">Using a cmdlet in a command.</span></span> <span data-ttu-id="89004-132">Typ bijvoorbeeld `Get-ExecutionPolicy` de module micro soft. Power shell. Security die de cmdlet bevat geïmporteerd `Get-ExecutionPolicy` .</span><span class="sxs-lookup"><span data-stu-id="89004-132">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="89004-133">Gebruik de [Get-opdracht](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet om de opdracht op te halen.</span><span class="sxs-lookup"><span data-stu-id="89004-133">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span> <span data-ttu-id="89004-134">Als u bijvoorbeeld typt, wordt `Get-Command Get-JobTrigger` de **PSScheduledJob** -module met de `Get-JobTrigger` cmdlet geïmporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-134">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="89004-135">Een `Get-Command` opdracht die joker tekens bevat, wordt beschouwd als detectie en het importeren van een module wordt niet geactiveerd.</span><span class="sxs-lookup"><span data-stu-id="89004-135">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="89004-136">Met de cmdlet [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) kunt u hulp krijgen bij een cmdlet.</span><span class="sxs-lookup"><span data-stu-id="89004-136">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="89004-137">Typ bijvoorbeeld `Get-Help Get-WinEvent` de module micro soft. Power shell. Diagnostics die de cmdlet bevat geïmporteerd `Get-WinEvent` .</span><span class="sxs-lookup"><span data-stu-id="89004-137">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="89004-138">Ter ondersteuning van het automatisch importeren van modules, worden met de `Get-Command` cmdlet alle cmdlets en functies in alle geïnstalleerde modules opgehaald, zelfs als de module niet in de sessie is geïmporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-138">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="89004-139">Zie het Help-onderwerp voor de cmdlet [Get-opdracht](/powershell/module/Microsoft.PowerShell.Core/Get-Command) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="89004-139">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="89004-140">Het import proces</span><span class="sxs-lookup"><span data-stu-id="89004-140">The Importing Process</span></span>

<span data-ttu-id="89004-141">Wanneer een module wordt geïmporteerd, wordt een nieuwe sessie status voor de module gemaakt en wordt er een [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -object in het geheugen gemaakt.</span><span class="sxs-lookup"><span data-stu-id="89004-141">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="89004-142">Er wordt een sessie status gemaakt voor elke module die wordt geïmporteerd (dit omvat de hoofd module en eventuele geneste modules).</span><span class="sxs-lookup"><span data-stu-id="89004-142">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="89004-143">De leden die worden geëxporteerd uit de hoofd module, inclusief alle leden die zijn geëxporteerd naar de hoofd module door een geneste modules, worden vervolgens geïmporteerd in de sessie status van de aanroeper.</span><span class="sxs-lookup"><span data-stu-id="89004-143">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="89004-144">De meta gegevens van leden die vanuit een module worden geëxporteerd, hebben een eigenschap van de module naam.</span><span class="sxs-lookup"><span data-stu-id="89004-144">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="89004-145">Deze eigenschap wordt gevuld met de naam van de module die deze heeft geëxporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-145">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="89004-146">Als de naam van een geëxporteerd lid een niet-goedgekeurde term gebruikt of als de naam van het lid beperkte tekens gebruikt, wordt er een waarschuwing weer gegeven wanneer de [import-module-](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="89004-146">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="89004-147">De cmdlet [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) retourneert standaard geen objecten aan de pijp lijn.</span><span class="sxs-lookup"><span data-stu-id="89004-147">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="89004-148">De cmdlet ondersteunt echter een **PassThru** -para meter die kan worden gebruikt om een [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -object te retour neren voor elke module die wordt geïmporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-148">However, the cmdlet supports a **PassThru** parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="89004-149">Gebruikers moeten de [Write-host-](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet uitvoeren om de uitvoer naar de host te verzenden.</span><span class="sxs-lookup"><span data-stu-id="89004-149">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="89004-150">De leden die worden geïmporteerd beperken</span><span class="sxs-lookup"><span data-stu-id="89004-150">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="89004-151">Wanneer een module wordt geïmporteerd met behulp van de cmdlet [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , worden alle geëxporteerde module leden standaard in de sessie geïmporteerd, met inbegrip van opdrachten die naar de module worden geëxporteerd door een geneste module.</span><span class="sxs-lookup"><span data-stu-id="89004-151">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="89004-152">Variabelen en aliassen worden standaard niet geëxporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-152">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="89004-153">Als u de geëxporteerde leden wilt beperken, gebruikt u een [module manifest](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="89004-153">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>
<span data-ttu-id="89004-154">Gebruik de volgende para meters van de cmdlet om de leden te beperken die worden geïmporteerd `Import-Module` .</span><span class="sxs-lookup"><span data-stu-id="89004-154">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="89004-155">**Functie**: deze para meter beperkt de functies die worden geëxporteerd.</span><span class="sxs-lookup"><span data-stu-id="89004-155">**Function**: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="89004-156">(Als u een module manifest gebruikt, raadpleegt u de sleutel FunctionsToExport.)</span><span class="sxs-lookup"><span data-stu-id="89004-156">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="89004-157">\`**Cmdlet**: deze para meter beperkt de cmdlets die worden geëxporteerd (als u een module manifest gebruikt, raadpleegt u de sleutel CmdletsToExport.)</span><span class="sxs-lookup"><span data-stu-id="89004-157">\`**Cmdlet**: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="89004-158">**Variabele**: met deze para meter worden de variabelen beperkt die worden geëxporteerd (als u een module manifest gebruikt, raadpleegt u de sleutel VariablesToExport.)</span><span class="sxs-lookup"><span data-stu-id="89004-158">**Variable**: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="89004-159">**Alias**: met deze para meter worden de aliassen beperkt die worden geëxporteerd (als u een module manifest gebruikt, raadpleegt u de sleutel AliasesToExport.)</span><span class="sxs-lookup"><span data-stu-id="89004-159">**Alias**: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="89004-160">Zie ook</span><span class="sxs-lookup"><span data-stu-id="89004-160">See Also</span></span>

[<span data-ttu-id="89004-161">Een Windows PowerShell-module schrijven</span><span class="sxs-lookup"><span data-stu-id="89004-161">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
