---
title: Het juiste Power shell NuGet-pakket kiezen voor uw .NET-project
description: Naast de uitvoer bare pakketten die zijn gepubliceerd met elke Power shell-versie, houdt het Power shell-team ook meerdere pakketten bij die beschikbaar zijn op NuGet. Met deze pakketten kan Power shell als een API-platform in .NET worden gericht.
ms.date: 06/25/2020
ms.custom: rjmholt
ms.openlocfilehash: 39369ed872faa76ad2c41d813da5e0a98cf1c078
ms.sourcegitcommit: d0461273abb6db099c5e784ef00f57fd551be4a6
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/01/2020
ms.locfileid: "85795423"
---
# <a name="choosing-the-right-powershell-nuget-package-for-your-net-project"></a><span data-ttu-id="a306c-104">Het juiste Power shell NuGet-pakket kiezen voor uw .NET-project</span><span class="sxs-lookup"><span data-stu-id="a306c-104">Choosing the right PowerShell NuGet package for your .NET project</span></span>

<span data-ttu-id="a306c-105">Naast de `pwsh` uitvoer bare pakketten die zijn gepubliceerd met elke Power shell-versie, houdt het Power shell-team ook meerdere pakketten bij die beschikbaar zijn op [NuGet][].</span><span class="sxs-lookup"><span data-stu-id="a306c-105">Alongside the `pwsh` executable packages published with each PowerShell release, the PowerShell team also maintains several packages available on [NuGet][].</span></span> <span data-ttu-id="a306c-106">Met deze pakketten kan Power shell als een API-platform in .NET worden gericht.</span><span class="sxs-lookup"><span data-stu-id="a306c-106">These packages allow targeting PowerShell as an API platform in .NET.</span></span>

<span data-ttu-id="a306c-107">Als .NET-toepassing die Api's levert en verwacht .NET-bibliotheken te laden die zijn eigen (binaire modules) implementeren, is het essentieel dat Power shell beschikbaar is in de vorm van een NuGet-pakket.</span><span class="sxs-lookup"><span data-stu-id="a306c-107">As a .NET application that provides APIs and expects to load .NET libraries implementing its own (binary modules), it's essential that PowerShell be available in the form of a NuGet package.</span></span>

<span data-ttu-id="a306c-108">Momenteel zijn er verschillende NuGet-pakketten die een weer gave van de Power shell-API surface area bieden.</span><span class="sxs-lookup"><span data-stu-id="a306c-108">Currently there are several NuGet packages that provide some representation of the PowerShell API surface area.</span></span> <span data-ttu-id="a306c-109">Welk pakket moet worden gebruikt met een bepaald project is niet altijd duidelijk gemaakt.</span><span class="sxs-lookup"><span data-stu-id="a306c-109">Which package to use with a particular project hasn't always been made clear.</span></span> <span data-ttu-id="a306c-110">In dit artikel wordt een lampje op enkele veelvoorkomende scenario's voor het Power shell-doel .NET-projecten uitgeschreven en wordt uitgelegd hoe u het juiste NuGet-pakket kunt kiezen voor het doel van uw Power shell-georiënteerd .NET-project.</span><span class="sxs-lookup"><span data-stu-id="a306c-110">This article sheds some light on a few common scenarios for PowerShell-targeting .NET projects and how to choose the right NuGet package to target for your PowerShell-oriented .NET project.</span></span>

## <a name="hosting-vs-referencing"></a><span data-ttu-id="a306c-111">Hosting versus referentie</span><span class="sxs-lookup"><span data-stu-id="a306c-111">Hosting vs referencing</span></span>

<span data-ttu-id="a306c-112">Sommige .NET-projecten proberen code te schrijven die moeten worden geladen in een bestaande Power shell-runtime (zoals `pwsh` , `powershell.exe` de Power Shell integrated console of de ISE), terwijl anderen Power shell in hun eigen toepassingen willen uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="a306c-112">Some .NET projects seek to write code to be loaded into a pre-existing PowerShell runtime (such as `pwsh`, `powershell.exe`, the PowerShell Integrated Console or the ISE), while others want to run PowerShell in their own applications.</span></span>

- <span data-ttu-id="a306c-113">**Verwijzingen** is voor wanneer een project, meestal een module, is bedoeld om te worden geladen in Power shell.</span><span class="sxs-lookup"><span data-stu-id="a306c-113">**Referencing** is for when a project, usually a module, is intended to be loaded into PowerShell.</span></span>
  <span data-ttu-id="a306c-114">Het moet worden gecompileerd op basis van de Api's die Power shell biedt om met de API te communiceren, maar de Power shell-implementatie wordt geleverd door het Power Shell-proces dat het laadt in.</span><span class="sxs-lookup"><span data-stu-id="a306c-114">It must be compiled against the APIs that PowerShell provides in order to interact with it, but the PowerShell implementation is supplied by the PowerShell process loading it in.</span></span> <span data-ttu-id="a306c-115">Voor het verwijzen naar een project kunnen [referentie-assembly's][] of de feitelijke runtime-assembly's Als compilatie doel worden gebruikt, maar moet er wel voor zorgen dat deze niet worden gepubliceerd met de build.</span><span class="sxs-lookup"><span data-stu-id="a306c-115">For referencing, a project can use [reference assemblies][] or the actual runtime assemblies as a compilation target, but must ensure that it does not publish any of these with its build.</span></span>
- <span data-ttu-id="a306c-116">**Hosting** is wanneer een project een eigen implementatie van Power shell nodig heeft, meestal omdat het een zelfstandige toepassing is die Power shell moet uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="a306c-116">**Hosting** is when a project needs its own implementation of PowerShell, usually because it is a standalone application that needs to run PowerShell.</span></span> <span data-ttu-id="a306c-117">In dit geval kunnen geen zuivere verwijzings-assembly's worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="a306c-117">In this case, pure reference assemblies cannot be used.</span></span> <span data-ttu-id="a306c-118">In plaats daarvan moet een concrete Power shell-implementatie zijn.</span><span class="sxs-lookup"><span data-stu-id="a306c-118">Instead, a concrete PowerShell implementation must be depended upon.</span></span> <span data-ttu-id="a306c-119">Omdat een concrete Power shell-implementatie moet worden gebruikt, moet er een specifieke versie van Power shell worden gekozen voor hosting. een toepassing met één host kan geen Power shell-versies met meerdere doelen hebben.</span><span class="sxs-lookup"><span data-stu-id="a306c-119">Because a concrete PowerShell implementation must be used, a specific version of PowerShell must be chosen for hosting; a single host application cannot multi-target PowerShell versions.</span></span>

### <a name="publishing-projects-that-target-powershell-as-a-reference"></a><span data-ttu-id="a306c-120">Projecten publiceren die als doel-Power shell als referentie dienen</span><span class="sxs-lookup"><span data-stu-id="a306c-120">Publishing projects that target PowerShell as a reference</span></span>

> [!NOTE]
> <span data-ttu-id="a306c-121">We gebruiken de term **Publish** in dit artikel om te verwijzen naar actief `dotnet publish` , waarmee een .net-bibliotheek wordt geplaatst in een map met alle afhankelijkheden, die gereed is voor implementatie naar een bepaalde runtime.</span><span class="sxs-lookup"><span data-stu-id="a306c-121">We use the term **publish** in this article to refer to running `dotnet publish`, which places a .NET library into a directory with all of its dependencies, ready for deployment to a particular runtime.</span></span>

<span data-ttu-id="a306c-122">U wordt aangeraden het [kenmerk PrivateAssets][]in te stellen om te voor komen dat u Project afhankelijkheden publiceert die alleen worden gebruikt als compilatie referentie doelen:</span><span class="sxs-lookup"><span data-stu-id="a306c-122">In order to prevent publishing project dependencies that are just being used as compilation reference targets, it is recommended to set the [PrivateAssets attribute][]:</span></span>

```xml
<PackageReference Include="PowerShellStandard.Library" Version="5.1.0.0" PrivateAssets="all" />
```

<span data-ttu-id="a306c-123">Als u dit vergeet en een referentie-assembly als doel gebruikt, ziet u mogelijk problemen met betrekking tot het gebruik van de standaard implementatie van de referentie-assembly in plaats van de daad werkelijke implementatie.</span><span class="sxs-lookup"><span data-stu-id="a306c-123">If you forget to do this and use a reference assembly as your target, you may see issues related to using the reference assembly's default implementation instead of the actual implementation.</span></span> <span data-ttu-id="a306c-124">Dit kan de vorm van a `NullReferenceException` zijn, omdat referentie assemblages de implementatie-API regel matig door voeren `null` .</span><span class="sxs-lookup"><span data-stu-id="a306c-124">This may take the form of a `NullReferenceException`, since reference assemblies often mock the implementation API by simply returning `null`.</span></span>

## <a name="key-kinds-of-powershell-targeting-net-projects"></a><span data-ttu-id="a306c-125">Belangrijkste soorten Power shell-doelen voor .NET-projecten</span><span class="sxs-lookup"><span data-stu-id="a306c-125">Key kinds of PowerShell-targeting .NET projects</span></span>

<span data-ttu-id="a306c-126">Hoewel elke .NET-bibliotheek of-toepassing Power shell kan insluiten, zijn er enkele veelvoorkomende scenario's voor het gebruik van Power shell-Api's:</span><span class="sxs-lookup"><span data-stu-id="a306c-126">While any .NET library or application can embed PowerShell, there are some common scenarios that use PowerShell APIs:</span></span>

- <span data-ttu-id="a306c-127">**Een binaire Power shell-module implementeren**</span><span class="sxs-lookup"><span data-stu-id="a306c-127">**Implementing a PowerShell binary module**</span></span>

  <span data-ttu-id="a306c-128">Binaire Power shell-modules zijn .NET-bibliotheken die worden geladen door Power shell en die Power shell-Api's moeten implementeren, zoals de [PSCmdlet][] -of [CmdletProvider][] -typen om cmdlets of providers respectievelijk te kunnen weer geven.</span><span class="sxs-lookup"><span data-stu-id="a306c-128">PowerShell binary modules are .NET libraries loaded by PowerShell that must implement PowerShell APIs like the [PSCmdlet][] or [CmdletProvider][] types in order to expose cmdlets or providers respectively.</span></span> <span data-ttu-id="a306c-129">Omdat ze zijn geladen in, kunnen modules worden gecompileerd op basis van verwijzingen naar Power shell zonder deze te publiceren in hun build.</span><span class="sxs-lookup"><span data-stu-id="a306c-129">Because they are loaded in, modules seek to compile against references to PowerShell without publishing it in their build.</span></span> <span data-ttu-id="a306c-130">Het is ook gebruikelijk dat modules meerdere Power shell-versies en-platforms willen ondersteunen, in het ideale geval met een minimum aan overhead van schijf ruimte, complexiteit of herhaalde implementatie.</span><span class="sxs-lookup"><span data-stu-id="a306c-130">It's also common for modules to want to support multiple PowerShell versions and platforms, ideally with a minimum of overhead of disk space, complexity, or repeated implementation.</span></span> <span data-ttu-id="a306c-131">Zie [about_Modules][] voor meer informatie over modules.</span><span class="sxs-lookup"><span data-stu-id="a306c-131">See [about_Modules][] for more information about modules.</span></span>

- <span data-ttu-id="a306c-132">**Een Power shell-host implementeren**</span><span class="sxs-lookup"><span data-stu-id="a306c-132">**Implementing a PowerShell Host**</span></span>

  <span data-ttu-id="a306c-133">Een Power shell-host biedt een interactie-laag voor de Power shell-runtime.</span><span class="sxs-lookup"><span data-stu-id="a306c-133">A PowerShell Host provides an interaction layer for the PowerShell runtime.</span></span> <span data-ttu-id="a306c-134">Het is een specifieke vorm van _Hosting_, waarbij een [PSHost][] wordt geïmplementeerd als een nieuwe gebruikers interface voor Power shell.</span><span class="sxs-lookup"><span data-stu-id="a306c-134">It is a specific form of _hosting_, where a [PSHost][] is implemented as a new user interface to PowerShell.</span></span> <span data-ttu-id="a306c-135">De Power shell-ConsoleHost biedt bijvoorbeeld een Terminal gebruikers interface voor uitvoer bare Power Shell-bestanden, terwijl de host van de Power shell-editor Services en de ISE-host beide een door een editor geïntegreerde, gedeeltelijk Graphical User Interface rond Power shell bieden.</span><span class="sxs-lookup"><span data-stu-id="a306c-135">For example, the PowerShell ConsoleHost provides a terminal user interface for PowerShell executables, while the PowerShell Editor Services Host and the ISE Host both provide an editor-integrated partially graphical user interface around PowerShell.</span></span> <span data-ttu-id="a306c-136">Hoewel het mogelijk is om een host te laden naar een bestaand Power Shell-proces, is het veel meer gebruikelijk voor een implementatie van een host om te fungeren als een zelfstandige Power shell-implementatie waarmee de Power shell-engine opnieuw wordt gedistribueerd.</span><span class="sxs-lookup"><span data-stu-id="a306c-136">While it's possible to load a host onto an existing PowerShell process, it's much more common for a host implementation to act as a standalone PowerShell implementation that redistributes the PowerShell engine.</span></span>

- <span data-ttu-id="a306c-137">**Aanroepen van Power shell vanuit een andere .NET-toepassing**</span><span class="sxs-lookup"><span data-stu-id="a306c-137">**Calling into PowerShell from another .NET application**</span></span>

  <span data-ttu-id="a306c-138">Net als bij elke toepassing kan Power shell worden aangeroepen als een subproces voor het uitvoeren van werk belastingen.</span><span class="sxs-lookup"><span data-stu-id="a306c-138">As with any application, PowerShell can be called as a subprocess to run workloads.</span></span> <span data-ttu-id="a306c-139">Als .NET-toepassing is het ook mogelijk om Power shell in-process aan te roepen om een back-up te krijgen van volledige .NET-objecten voor gebruik binnen de aanroepende toepassing.</span><span class="sxs-lookup"><span data-stu-id="a306c-139">However, as a .NET application, it's also possible to invoke PowerShell in-process to get back full .NET objects for use within the calling application.</span></span> <span data-ttu-id="a306c-140">Dit is een meer algemene vorm van _Hosting_, waarbij de toepassing een eigen Power shell-implementatie voor intern gebruik bevat.</span><span class="sxs-lookup"><span data-stu-id="a306c-140">This is a more general form of _hosting_, where the application holds its own PowerShell implementation for internal use.</span></span> <span data-ttu-id="a306c-141">Voor beelden hiervan zijn een service of daemon met Power shell voor het beheren van de computer status of een webtoepassing die Power shell op aanvraag uitvoert om iets te doen, zoals het beheren van Cloud implementaties.</span><span class="sxs-lookup"><span data-stu-id="a306c-141">Examples of this might be a service or daemon running PowerShell to manage machine state or a web application that runs PowerShell on request to do something like manage cloud deployments.</span></span>

- <span data-ttu-id="a306c-142">**Eenheid voor het testen van Power shell-modules vanuit .NET**</span><span class="sxs-lookup"><span data-stu-id="a306c-142">**Unit testing PowerShell modules from .NET**</span></span>

  <span data-ttu-id="a306c-143">Hoewel modules en andere bibliotheken die zijn ontworpen om de functionaliteit van Power shell beschikbaar te maken, voornamelijk moeten worden getest vanuit Power shell (wij adviseren u de [ziekte][]te testen), is het soms nood zakelijk dat u test-api's voor een Power shell-module van .net bijvoegt.</span><span class="sxs-lookup"><span data-stu-id="a306c-143">While modules and other libraries designed to expose functionality to PowerShell should be primarily tested from PowerShell (we recommend [Pester][]), sometimes it's necessary to unit test APIs written for a PowerShell module from .NET.</span></span> <span data-ttu-id="a306c-144">Deze situatie is afhankelijk van de code van de module die een aantal Power shell-versies probeert te richten, terwijl tests moeten worden uitgevoerd op specifieke, concrete implementaties.</span><span class="sxs-lookup"><span data-stu-id="a306c-144">This situation involves the module code trying to target a number of PowerShell versions, while testing should run it on specific, concrete implementations.</span></span>

## <a name="powershell-nuget-packages-at-a-glance"></a><span data-ttu-id="a306c-145">Power shell NuGet-pakketten in één oogopslag</span><span class="sxs-lookup"><span data-stu-id="a306c-145">PowerShell NuGet packages at a glance</span></span>

<span data-ttu-id="a306c-146">In dit artikel worden de volgende NuGet-pakketten besproken die Power shell-Api's beschikbaar maken:</span><span class="sxs-lookup"><span data-stu-id="a306c-146">In this article, we'll cover the following NuGet packages that expose PowerShell APIs:</span></span>

- <span data-ttu-id="a306c-147">[PowerShellStandard. Library][], een referentie-assembly waarmee u één assembly kunt bouwen die door meerdere Power shell-Runtimes kan worden geladen.</span><span class="sxs-lookup"><span data-stu-id="a306c-147">[PowerShellStandard.Library][], a reference assembly that enables building a single assembly that can be loaded by multiple PowerShell runtimes.</span></span>
- <span data-ttu-id="a306c-148">[Micro soft. Power shell. SDK][], de manier waarop u de hele Power shell SDK kunt richten en hosten</span><span class="sxs-lookup"><span data-stu-id="a306c-148">[Microsoft.PowerShell.SDK][], the way to target and rehost the whole PowerShell SDK</span></span>
- <span data-ttu-id="a306c-149">Het [System. Management. Automation][] -pakket, de kern runtime van Power shell en Engine-implementatie, dat nuttig kan zijn bij minimale gehoste implementaties en voor versie-specifieke doel scenario's.</span><span class="sxs-lookup"><span data-stu-id="a306c-149">The [System.Management.Automation][] package, the core PowerShell runtime and engine implementation, that can be useful in minimal hosted implementations and for version-specific targeting scenarios.</span></span>
- <span data-ttu-id="a306c-150">De **Windows Power shell-referentie-assembly's**, de manier om Windows Power shell te richten en effectief opnieuw te hosten (Power shell-versies 5,1 en lager).</span><span class="sxs-lookup"><span data-stu-id="a306c-150">The **Windows PowerShell reference assemblies**, the way to target and effectively rehost Windows PowerShell (PowerShell versions 5.1 and below).</span></span>

> [!NOTE]
> <span data-ttu-id="a306c-151">Het [Power shell NuGet][] -pakket is helemaal geen .net-bibliotheek pakket, maar voorziet in plaats daarvan de implementatie van het globale hulp programma van Power shell dotnet.</span><span class="sxs-lookup"><span data-stu-id="a306c-151">The [PowerShell NuGet][] package is not a .NET library package at all, but instead provides the PowerShell dotnet global tool implementation.</span></span> <span data-ttu-id="a306c-152">Dit mag niet worden gebruikt door projecten, omdat deze alleen een uitvoerbaar bestand bevat.</span><span class="sxs-lookup"><span data-stu-id="a306c-152">This should not be used by any projects, since it only provides an executable.</span></span>

## <a name="powershellstandardlibrary"></a><span data-ttu-id="a306c-153">PowerShellStandard. Library</span><span class="sxs-lookup"><span data-stu-id="a306c-153">PowerShellStandard.Library</span></span>

<span data-ttu-id="a306c-154">De standaard bibliotheek van Power shell is een referentie-assembly die het snij punt van de Api's van de Power shell-versie 7, 6 en 5,1 vastlegt.</span><span class="sxs-lookup"><span data-stu-id="a306c-154">The PowerShell Standard library is a reference assembly that captures the intersection of the APIs of PowerShell versions 7, 6 and 5.1.</span></span> <span data-ttu-id="a306c-155">Dit biedt een API-Opper vlak met gecontroleerde compilaties om .NET-code te compileren, zodat .NET-projecten de Power shell-versie 7, 6 en 5,1 kunnen richten, zonder dat er sprake is van het aanroepen van een API.</span><span class="sxs-lookup"><span data-stu-id="a306c-155">This provides a compile-time-checked API surface to compile .NET code against, allowing .NET projects to target PowerShell versions 7, 6 and 5.1 without risking calling an API that won't be there.</span></span>

<span data-ttu-id="a306c-156">Power shell Standard is bedoeld voor het schrijven van Power shell-modules of andere code die alleen is bedoeld om te worden uitgevoerd na het laden in een Power Shell-proces.</span><span class="sxs-lookup"><span data-stu-id="a306c-156">PowerShell Standard is intended for writing PowerShell modules, or other code only intended to be run after loading it into a PowerShell process.</span></span> <span data-ttu-id="a306c-157">Omdat het een referentie-assembly is, bevat Power shell Standard geen implementatie zelf, dus biedt geen functionaliteit voor zelfstandige toepassingen.</span><span class="sxs-lookup"><span data-stu-id="a306c-157">Because it is a reference assembly, PowerShell Standard contains no implementation itself, so provides no functionality for standalone applications.</span></span>

### <a name="using-powershell-standard-with-different-net-runtimes"></a><span data-ttu-id="a306c-158">Power shell Standard gebruiken met verschillende .NET-Runtimes</span><span class="sxs-lookup"><span data-stu-id="a306c-158">Using PowerShell Standard with different .NET runtimes</span></span>

<span data-ttu-id="a306c-159">Power shell Standard streeft naar de [.NET Standard 2,0][] -doel-runtime, een gevel-runtime die is ontworpen om een gemeen schappelijk Surface Area te bieden dat wordt gedeeld door .NET Framework en .net core.</span><span class="sxs-lookup"><span data-stu-id="a306c-159">PowerShell Standard targets the [.NET Standard 2.0][] target runtime, which is a façade runtime designed to provide a common surface area shared by .NET Framework and .NET Core.</span></span> <span data-ttu-id="a306c-160">Dit maakt het mogelijk om één enkele runtime te maken die geschikt is voor meerdere Power shell-versies, maar heeft de volgende consequenties:</span><span class="sxs-lookup"><span data-stu-id="a306c-160">This allows targeting a single runtime to produce a single assembly that will work with multiple PowerShell versions, but has the following consequences:</span></span>

- <span data-ttu-id="a306c-161">Voor het laden van de module of bibliotheek in Power shell moet mini maal .NET 4.6.1; .net 4,6 en .NET 4.5.2 worden uitgevoerd. geen ondersteuning voor .NET Standard.</span><span class="sxs-lookup"><span data-stu-id="a306c-161">The PowerShell loading the module or library must be running a minimum of .NET 4.6.1; .NET 4.6 and .NET 4.5.2 do not support .NET Standard.</span></span> <span data-ttu-id="a306c-162">Een nieuwere versie van Windows Power shell betekent geen nieuwere versie van .NET Framework. Windows Power shell 5,1 kan worden uitgevoerd op .NET 4.5.2.</span><span class="sxs-lookup"><span data-stu-id="a306c-162">Note that a newer Windows PowerShell version does not mean a newer .NET Framework version; Windows PowerShell 5.1 may run on .NET 4.5.2.</span></span>
- <span data-ttu-id="a306c-163">Als u wilt werken met een Power shell met .NET Framework 4.7.1 of lager, moet u de .NET 4.6.1 [netstandard. Library][] -implementatie nodig hebben om de netstandard.dll en andere Shim-assembly's in oudere .NET Framework versies op te geven.</span><span class="sxs-lookup"><span data-stu-id="a306c-163">In order to work with a PowerShell running .NET Framework 4.7.1 or below, the .NET 4.6.1 [NETStandard.Library][] implementation is required to provide the netstandard.dll and other shim assemblies in older .NET Framework versions.</span></span>

<span data-ttu-id="a306c-164">Power shell 6 + bevat een eigen Shim-assembly voor type door sturen van .NET Framework 4.6.1 (en hoger) naar .NET core.</span><span class="sxs-lookup"><span data-stu-id="a306c-164">PowerShell 6+ provides its own shim assemblies for type forwarding from .NET Framework 4.6.1 (and above) to .NET Core.</span></span> <span data-ttu-id="a306c-165">Dit betekent dat als een module alleen Api's gebruikt die in .NET Core zijn opgenomen, Power shell 6 + kan worden geladen en uitgevoerd wanneer deze is gemaakt voor .NET Framework 4.6.1 (het `net461` runtime-doel).</span><span class="sxs-lookup"><span data-stu-id="a306c-165">This means that as long as a module uses only APIs that exist in .NET Core, PowerShell 6+ can load and run it when it has been built for .NET Framework 4.6.1 (the `net461` runtime target).</span></span>

<span data-ttu-id="a306c-166">Dit betekent dat binaire modules die gebruikmaken van Power shell Standard om meerdere Power shell-versies te richten met één gepubliceerd DLL-bestand twee opties hebben:</span><span class="sxs-lookup"><span data-stu-id="a306c-166">This means that binary modules using PowerShell Standard to target multiple PowerShell versions with a single published DLL have two options:</span></span>

1. <span data-ttu-id="a306c-167">Publiceren van een assembly die is gemaakt voor de runtime van de `net461` doel groep.</span><span class="sxs-lookup"><span data-stu-id="a306c-167">Publishing an assembly built for the `net461` target runtime.</span></span> <span data-ttu-id="a306c-168">Dit omvat:</span><span class="sxs-lookup"><span data-stu-id="a306c-168">This involves:</span></span>
   - <span data-ttu-id="a306c-169">Het project voor de `net461` runtime publiceren</span><span class="sxs-lookup"><span data-stu-id="a306c-169">Publishing the project for the `net461` runtime</span></span>
   - <span data-ttu-id="a306c-170">U kunt ook compileren op basis `netstandard2.0` van de runtime (zonder de build-uitvoer) te gebruiken om ervoor te zorgen dat alle gebruikte api's ook aanwezig zijn in .net core.</span><span class="sxs-lookup"><span data-stu-id="a306c-170">Also compiling against the `netstandard2.0` runtime (without using its build output) to ensure that all APIs used are also present in .NET Core.</span></span>

1. <span data-ttu-id="a306c-171">Een assembly-build publiceren voor de runtime van de `netstandard2.0` doel groep.</span><span class="sxs-lookup"><span data-stu-id="a306c-171">Publishing an assembly build for the `netstandard2.0` target runtime.</span></span> <span data-ttu-id="a306c-172">Dit vereist:</span><span class="sxs-lookup"><span data-stu-id="a306c-172">This requires:</span></span>
   - <span data-ttu-id="a306c-173">Het project voor de `netstandard2.0` runtime publiceren</span><span class="sxs-lookup"><span data-stu-id="a306c-173">Publishing the project for the `netstandard2.0` runtime</span></span>
   - <span data-ttu-id="a306c-174">Het nemen `net461` van de afhankelijkheden van netstandard. Library en het kopiëren ervan naar de publicatie locatie van de assembly van het project, zodat de assembly met type-doorgestuurd is gecorrigeerd in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a306c-174">Taking the `net461` dependencies of NETStandard.Library and copying them into the project assembly's publish location so that the assembly is type-forwarded corrected in .NET Framework.</span></span>

<span data-ttu-id="a306c-175">Als u Power shell-modules of-bibliotheken wilt maken die zijn gericht op oudere versies van .NET Framework, is het wellicht beter om te richten op meerdere .NET-Runtimes.</span><span class="sxs-lookup"><span data-stu-id="a306c-175">To build PowerShell modules or libraries targeting older .NET Framework versions, it may be preferable to target multiple .NET runtimes.</span></span> <span data-ttu-id="a306c-176">Hiermee wordt een assembly voor elke runtime-doel publicatie gepubliceerd en de juiste assembly moet worden geladen in de module laad tijd (bijvoorbeeld met een kleine psm1 als de hoofd module).</span><span class="sxs-lookup"><span data-stu-id="a306c-176">This will publish an assembly for each target runtime, and the correct assembly will need to be loaded at module load time (for example with a small psm1 as the root module).</span></span>

### <a name="testing-powershell-standard-projects-in-net"></a><span data-ttu-id="a306c-177">Power shell Standard-projecten testen in .NET</span><span class="sxs-lookup"><span data-stu-id="a306c-177">Testing PowerShell Standard projects in .NET</span></span>

<span data-ttu-id="a306c-178">Wanneer het gaat om uw module te testen in .NET test lopers zoals xUnit, moet u er rekening mee houden dat compilaties niet tot nu toe kunnen gaan.</span><span class="sxs-lookup"><span data-stu-id="a306c-178">When it comes to testing your module in .NET test runners like xUnit, remember that compile-time checks can only go so far.</span></span> <span data-ttu-id="a306c-179">U moet uw module testen op de relevante Power shell-platforms.</span><span class="sxs-lookup"><span data-stu-id="a306c-179">You must test your module against the relevant PowerShell platforms.</span></span>

<span data-ttu-id="a306c-180">Als u Api's wilt testen die zijn gebouwd op basis van Power shell Standard in .NET, moet u `Microsoft.Powershell.SDK` een test afhankelijkheid toevoegen met .net core (waarbij de versie is ingesteld op overeenkomen met de gewenste Power shell-versie) en de juiste Windows Power shell-referentie-assembly's met .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a306c-180">To test APIs built against PowerShell Standard in .NET, you should add `Microsoft.Powershell.SDK` as a testing dependency with .NET Core (with the version set to match the desired PowerShell version), and the appropriate Windows PowerShell reference assemblies with .NET Framework.</span></span>

<span data-ttu-id="a306c-181">Zie [dit blog bericht][]voor meer informatie over Power shell Standard en het gebruik ervan om een binaire module te schrijven die in meerdere Power shell-versies kan worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="a306c-181">For more information on PowerShell Standard and using it to write a binary module that works in multiple PowerShell versions, see [this blog post][].</span></span> <span data-ttu-id="a306c-182">Zie ook de [standaard opslagplaats voor Power shell][] op github.</span><span class="sxs-lookup"><span data-stu-id="a306c-182">Also see the [PowerShell Standard repository][] on GitHub.</span></span>

## <a name="microsoftpowershellsdk"></a><span data-ttu-id="a306c-183">Micro soft. Power shell. SDK</span><span class="sxs-lookup"><span data-stu-id="a306c-183">Microsoft.PowerShell.SDK</span></span>

<span data-ttu-id="a306c-184">`Microsoft.PowerShell.SDK` is een meta pakket dat alle onderdelen van de Power shell-SDK ophaalt in één NuGet-pakket.</span><span class="sxs-lookup"><span data-stu-id="a306c-184">`Microsoft.PowerShell.SDK` is a meta-package that pulls together all of the components of the PowerShell SDK into a single NuGet package.</span></span> <span data-ttu-id="a306c-185">Een op zichzelf staande .NET-toepassing kan micro soft. Power shell. SDK gebruiken om wille keurige Power shell-functionaliteit uit te voeren zonder dat dit afhankelijk is van externe Power shell-installaties of-bibliotheken.</span><span class="sxs-lookup"><span data-stu-id="a306c-185">A self-contained .NET application can use Microsoft.PowerShell.SDK to run arbitrary PowerShell functionality without depending on any external PowerShell installations or libraries.</span></span>

> [!NOTE]
> <span data-ttu-id="a306c-186">De Power shell SDK verwijst alleen naar alle onderdeel pakketten waaruit Power shell is opgebouwd en die kan worden gebruikt voor .NET-ontwikkeling met Power shell.</span><span class="sxs-lookup"><span data-stu-id="a306c-186">The PowerShell SDK just refers to all the component packages that make up PowerShell, and which can be used for .NET development with PowerShell.</span></span>

<span data-ttu-id="a306c-187">Een bepaalde `Microsoft.Powershell.SDK` versie bevat de concrete implementatie van dezelfde versie van de Power shell-toepassing. versie 7,0 bevat de implementatie van Power shell 7,0 en het uitvoeren van opdrachten of scripts met de-service is grotendeels hetzelfde als het uitvoeren van deze in Power shell 7,0.</span><span class="sxs-lookup"><span data-stu-id="a306c-187">A given `Microsoft.Powershell.SDK` version contains the concrete implementation of the same version of the PowerShell application; version 7.0 contains the implementation of PowerShell 7.0 and running commands or scripts with it will largely behave like running them in PowerShell 7.0.</span></span>

<span data-ttu-id="a306c-188">Het uitvoeren van Power shell-opdrachten uit de SDK is voornamelijk, maar niet volledig, hetzelfde als het uitvoeren van `pwsh` .</span><span class="sxs-lookup"><span data-stu-id="a306c-188">Running PowerShell commands from the SDK is mostly, but not totally, the same as running them from `pwsh`.</span></span> <span data-ttu-id="a306c-189">[Begin-taak][] is bijvoorbeeld op dit moment afhankelijk van het `pwsh` uitvoer bare bestand dat beschikbaar is en werkt daarom niet `Microsoft.Powershell.SDK` standaard.</span><span class="sxs-lookup"><span data-stu-id="a306c-189">For example, [Start-Job][] currently depends on the `pwsh` executable being available, and so will not work with `Microsoft.Powershell.SDK` by default.</span></span>

<span data-ttu-id="a306c-190">Door `Microsoft.Powershell.SDK` te richten op basis van een .NET-toepassing kunt u met alle implementatie-assembly's van Power shell, zoals `System.Management.Automation` , `Microsoft.PowerShell.Management` en andere module-assembly's, integreren.</span><span class="sxs-lookup"><span data-stu-id="a306c-190">Targeting `Microsoft.Powershell.SDK` from a .NET application allows you to integrate with all of PowerShell's implementation assemblies, such as `System.Management.Automation`, `Microsoft.PowerShell.Management`, and other module assemblies.</span></span>

<span data-ttu-id="a306c-191">Het publiceren van een toepassings doel `Microsoft.Powershell.SDK` bevat al deze assembly's en alle afhankelijkheden van Power shell zijn vereist.</span><span class="sxs-lookup"><span data-stu-id="a306c-191">Publishing an application targeting `Microsoft.Powershell.SDK` will include all these assemblies, and any dependencies PowerShell requires.</span></span> <span data-ttu-id="a306c-192">Het bevat ook andere assets die Power shell nodig heeft voor de build, zoals de module manifesten voor `Microsoft.PowerShell.*` modules en de `ref` map die is vereist door [add-type][].</span><span class="sxs-lookup"><span data-stu-id="a306c-192">It will also include other assets that PowerShell required in its build, such as the module manifests for `Microsoft.PowerShell.*` modules and the `ref` directory required by [Add-Type][].</span></span>

<span data-ttu-id="a306c-193">Gezien de volledigheid van `Microsoft.Powershell.SDK` , is het het meest geschikt voor:</span><span class="sxs-lookup"><span data-stu-id="a306c-193">Given the completeness of `Microsoft.Powershell.SDK`, it's best suited for:</span></span>

- <span data-ttu-id="a306c-194">Implementatie van Power shell-hosts.</span><span class="sxs-lookup"><span data-stu-id="a306c-194">Implementation of PowerShell hosts.</span></span>
- <span data-ttu-id="a306c-195">xUnit test van bibliotheken die zijn gericht op Power shell-referentie-assembly's.</span><span class="sxs-lookup"><span data-stu-id="a306c-195">xUnit testing of libraries targeting PowerShell reference assemblies.</span></span>
- <span data-ttu-id="a306c-196">Power shell in-process aanroepen vanuit een .NET-toepassing.</span><span class="sxs-lookup"><span data-stu-id="a306c-196">Invoking PowerShell in-process from a .NET application.</span></span>

<span data-ttu-id="a306c-197">`Microsoft.PowerShell.SDK` kan ook worden gebruikt als een referentie doel wanneer een .NET-project is bedoeld om te worden gebruikt als module of anderszins wordt geladen door Power shell, maar is afhankelijk van Api's die alleen in een bepaalde versie van Power shell aanwezig zijn.</span><span class="sxs-lookup"><span data-stu-id="a306c-197">`Microsoft.PowerShell.SDK` may also be used as a reference target when a .NET project is intended to be used as a module or otherwise loaded by PowerShell, but depends on APIs only present in a particular version of PowerShell.</span></span> <span data-ttu-id="a306c-198">Houd er rekening mee dat een assembly die wordt gepubliceerd voor een specifieke versie van `Microsoft.PowerShell.SDK` , alleen veilig kan worden geladen en gebruikt in die versie van Power shell.</span><span class="sxs-lookup"><span data-stu-id="a306c-198">Note that an assembly published against a specific version of `Microsoft.PowerShell.SDK` will only be safe to load and use in that version of PowerShell.</span></span> <span data-ttu-id="a306c-199">Als u meerdere Power shell-versies met specifieke Api's wilt richten, zijn er meerdere builds vereist, waarbij elk een eigen versie van heeft `Microsoft.Powershell.SDK` .</span><span class="sxs-lookup"><span data-stu-id="a306c-199">To target multiple PowerShell versions with specific APIs, multiple builds are required, each targeting their own version of `Microsoft.Powershell.SDK`.</span></span>

> [!NOTE]
> <span data-ttu-id="a306c-200">De Power shell SDK is alleen beschikbaar voor Power shell versie 6 en hoger.</span><span class="sxs-lookup"><span data-stu-id="a306c-200">The PowerShell SDK is only available for PowerShell versions 6 and up.</span></span> <span data-ttu-id="a306c-201">Als u gelijkwaardige functionaliteit wilt bieden met Windows Power shell, gebruikt u de Windows Power shell-referentie-assembly's die hieronder worden beschreven.</span><span class="sxs-lookup"><span data-stu-id="a306c-201">To provide equivalent functionality with Windows PowerShell, use the Windows PowerShell reference assemblies described below.</span></span>

## <a name="systemmanagementautomation"></a><span data-ttu-id="a306c-202">System. Management. Automation</span><span class="sxs-lookup"><span data-stu-id="a306c-202">System.Management.Automation</span></span>

<span data-ttu-id="a306c-203">Het `System.Management.Automation` pakket is de kern van de Power shell-SDK.</span><span class="sxs-lookup"><span data-stu-id="a306c-203">The `System.Management.Automation` package is the heart of the PowerShell SDK.</span></span> <span data-ttu-id="a306c-204">Deze bestaat op NuGet, voornamelijk als een Asset voor `Microsoft.Powershell.SDK` het intrekken van.</span><span class="sxs-lookup"><span data-stu-id="a306c-204">It exists on NuGet, primarily, as an asset for `Microsoft.Powershell.SDK` to pull in.</span></span> <span data-ttu-id="a306c-205">Het kan echter ook rechtstreeks worden gebruikt als een pakket voor kleinere hosting scenario's en modules voor versie doelen.</span><span class="sxs-lookup"><span data-stu-id="a306c-205">However, it can also be used directly as a package for smaller hosting scenarios and version-targeting modules.</span></span>

<span data-ttu-id="a306c-206">Het is `System.Management.Automation` met name mogelijk dat het pakket een wille keurige provider van de Power shell-functionaliteit is wanneer:</span><span class="sxs-lookup"><span data-stu-id="a306c-206">Specifically, the `System.Management.Automation` package may be a preferable provider of PowerShell functionality when:</span></span>

- <span data-ttu-id="a306c-207">U wilt nu alleen de Power shell-taal functionaliteit (in de `System.Management.Automation.Language` naam ruimte) gebruiken, zoals de Power shell-parser, AST en de AST bezoekers api's (bijvoorbeeld voor statische analyse van Power shell).</span><span class="sxs-lookup"><span data-stu-id="a306c-207">You're only looking to use PowerShell language functionality (in the `System.Management.Automation.Language` namespace) like the PowerShell parser, AST, and AST visitor APIs (for example for static analysis of PowerShell).</span></span>
- <span data-ttu-id="a306c-208">U wilt alleen specifieke opdrachten uitvoeren vanuit de `Microsoft.PowerShell.Core` module en deze uitvoeren in een sessie status die is gemaakt met de [CreateDefault2][] -standaard methode.</span><span class="sxs-lookup"><span data-stu-id="a306c-208">You only wish to execute specific commands from the `Microsoft.PowerShell.Core` module and can execute them in a session state created with the [CreateDefault2][] factory method.</span></span>

<span data-ttu-id="a306c-209">Daarnaast `System.Management.Automation` is een handige referentie-assembly als:</span><span class="sxs-lookup"><span data-stu-id="a306c-209">Additionally, `System.Management.Automation` is a useful reference assembly when:</span></span>

- <span data-ttu-id="a306c-210">U wilt Api's richten die alleen aanwezig zijn in een specifieke Power shell-versie</span><span class="sxs-lookup"><span data-stu-id="a306c-210">You wish to target APIs that are only present within a specific PowerShell version</span></span>
- <span data-ttu-id="a306c-211">U bent niet afhankelijk van typen buiten de `System.Management.Automation` Assembly (bijvoorbeeld typen geëxporteerd door cmdlets in `Microsoft.PowerShell.*` modules).</span><span class="sxs-lookup"><span data-stu-id="a306c-211">You won't be depending on types occurring outside the `System.Management.Automation` assembly (for example, types exported by cmdlets in `Microsoft.PowerShell.*` modules).</span></span>

## <a name="windows-powershell-reference-assemblies"></a><span data-ttu-id="a306c-212">Windows Power shell-referentie-assembly's</span><span class="sxs-lookup"><span data-stu-id="a306c-212">Windows PowerShell reference assemblies</span></span>

<span data-ttu-id="a306c-213">Voor Power shell versie 5,1 en ouder (Windows Power shell) is er geen SDK voor het leveren van een implementatie van Power shell, omdat de implementatie van Windows Power shell deel uitmaakt van Windows.</span><span class="sxs-lookup"><span data-stu-id="a306c-213">For PowerShell versions 5.1 and older (Windows PowerShell), there is no SDK to provide an implementation of PowerShell, since Windows PowerShell's implementation is a part of Windows.</span></span>

<span data-ttu-id="a306c-214">In plaats daarvan bieden de referentie-assembly's van Windows Power shell zowel referentie doelen als een manier om Windows Power shell opnieuw te hosten. dit doet hetzelfde als de Power shell SDK voor versie 6 en hoger.</span><span class="sxs-lookup"><span data-stu-id="a306c-214">Instead, the Windows PowerShell reference assemblies provide both reference targets and a way to rehost Windows PowerShell, acting the same as the PowerShell SDK does for versions 6 and up.</span></span>

<span data-ttu-id="a306c-215">Windows Power shell-referentie-assembly's hebben in plaats van onderscheid te maken met versie een ander pakket voor elke versie van Windows Power shell:</span><span class="sxs-lookup"><span data-stu-id="a306c-215">Rather than being differentiated by version, Windows PowerShell reference assemblies have a different package for each version of Windows PowerShell:</span></span>

- [<span data-ttu-id="a306c-216">PowerShell 5.1</span><span class="sxs-lookup"><span data-stu-id="a306c-216">PowerShell 5.1</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.5.ReferenceAssemblies/)
- [<span data-ttu-id="a306c-217">Power Shell 4</span><span class="sxs-lookup"><span data-stu-id="a306c-217">PowerShell 4</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.4.ReferenceAssemblies/)
- [<span data-ttu-id="a306c-218">Power Shell 3</span><span class="sxs-lookup"><span data-stu-id="a306c-218">PowerShell 3</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.3.ReferenceAssemblies/)

<span data-ttu-id="a306c-219">Informatie over het gebruik van de Windows Power shell-referentie-assembly's vindt u in de [Windows Power shell-SDK][].</span><span class="sxs-lookup"><span data-stu-id="a306c-219">Information on how to use the Windows PowerShell reference assemblies can be found in the [Windows PowerShell SDK][].</span></span>

## <a name="real-world-examples-using-these-nuget-packages"></a><span data-ttu-id="a306c-220">Praktijk voorbeelden die gebruikmaken van deze NuGet-pakketten</span><span class="sxs-lookup"><span data-stu-id="a306c-220">Real-world examples using these NuGet packages</span></span>

<span data-ttu-id="a306c-221">Verschillende Power shell-hulp programma projecten richten zich op verschillende Power shell NuGet-pakketten, afhankelijk van hun behoeften.</span><span class="sxs-lookup"><span data-stu-id="a306c-221">Different PowerShell tooling projects target different PowerShell NuGet packages depending on their needs.</span></span> <span data-ttu-id="a306c-222">Hieronder vindt u enkele voor beelden.</span><span class="sxs-lookup"><span data-stu-id="a306c-222">Listed here are some notable examples.</span></span>

### <a name="psreadline"></a><span data-ttu-id="a306c-223">PSReadLine</span><span class="sxs-lookup"><span data-stu-id="a306c-223">PSReadLine</span></span>

<span data-ttu-id="a306c-224">[PSReadLine][], de Power shell-module die een groot deel van de veelzijdige console-ervaring van Power shell biedt, streeft naar een Power Shell-standaard als afhankelijkheid in plaats van een specifieke Power shell-versie en streeft naar de `net461` .NET-runtime in de [csproj][].</span><span class="sxs-lookup"><span data-stu-id="a306c-224">[PSReadLine][], the PowerShell module that provides much of PowerShell's rich console experience, targets PowerShell Standard as a dependency rather than a specific PowerShell version, and targets the `net461` .NET runtime in its [csproj][].</span></span>

<span data-ttu-id="a306c-225">Power shell 6 + levert een eigen Shim-assembly waarmee een DLL kan `net461` worden gebruikt voor het uitvoeren van ' alleen werk ' in (door het omleiden van bindingen met .NET Framework `mscorlib.dll` naar de relevante .net core-Assembly).</span><span class="sxs-lookup"><span data-stu-id="a306c-225">PowerShell 6+ supplies its own shim assemblies that allow a DLL targeting the `net461` runtime to "just work" when loaded in (by redirecting binding to .NET Framework's `mscorlib.dll` to the relevant .NET Core assembly).</span></span>

<span data-ttu-id="a306c-226">Dit vereenvoudigt de lay-out van de module en de levering aanzienlijk, omdat Power Shell-standaard garandeert dat alleen de gebruikte Api's aanwezig zijn in Power shell 5,1 en Power shell 6 +, terwijl de module ook kan verzenden met slechts één assembly.</span><span class="sxs-lookup"><span data-stu-id="a306c-226">This simplifies PSReadLine's module layout and delivery significantly, since PowerShell Standard ensures the only APIs used will be present in both PowerShell 5.1 and PowerShell 6+, while also allowing the module to ship with only a single assembly.</span></span>

<span data-ttu-id="a306c-227">Het .NET 4.6.1-doel houdt in dat Windows Power shell die wordt uitgevoerd op .NET 4.5.2 en .NET 4,6, echter niet wordt ondersteund.</span><span class="sxs-lookup"><span data-stu-id="a306c-227">The .NET 4.6.1 target does mean that Windows PowerShell running on .NET 4.5.2 and .NET 4.6 is not supported though.</span></span>

### <a name="powershell-editor-services"></a><span data-ttu-id="a306c-228">Power shell editor-Services</span><span class="sxs-lookup"><span data-stu-id="a306c-228">PowerShell Editor Services</span></span>

<span data-ttu-id="a306c-229">[Power shell editor Services][] (PSES) is de back-end voor de [Power shell-extensie][] voor [Visual Studio code][]en is in feite een vorm van Power shell-module die wordt geladen door een uitvoerbaar bestand van Power shell</span><span class="sxs-lookup"><span data-stu-id="a306c-229">[PowerShell Editor Services][] (PSES) is the backend for the [PowerShell extension][] for [Visual Studio Code][], and is actually a form of PowerShell module that gets loaded by a PowerShell executable and then takes over that process to rehost PowerShell within itself while also providing Language Service Protocol and Debug Adapter features.</span></span>

<span data-ttu-id="a306c-230">PSES biedt concrete implementatie doelen voor de `netcoreapp2.1` doel-Power shell 6 + (omdat runtime van Power shell 7 `netcoreapp3.1` achterwaarts compatibel is) en `net461` op Windows Power shell 5,1, maar bevat het meren deel van de logica in een tweede assembly die is gericht op `netstandard2.0` en Power shell Standard.</span><span class="sxs-lookup"><span data-stu-id="a306c-230">PSES provides concrete implementation targets for `netcoreapp2.1` to target PowerShell 6+ (since PowerShell 7's `netcoreapp3.1` runtime is backwards compatible) and `net461` to target Windows PowerShell 5.1, but contains most of its logic in a second assembly that targets `netstandard2.0` and PowerShell Standard.</span></span> <span data-ttu-id="a306c-231">Hierdoor kunnen ze afhankelijkheden ophalen die vereist zijn voor .NET core-en .NET Framework-platformen, terwijl het grootste deel van de code base nog steeds wordt vereenvoudigd bij een uniforme abstractie.</span><span class="sxs-lookup"><span data-stu-id="a306c-231">This allows it to pull in dependencies required for .NET Core and .NET Framework platforms, while still simplifying most of the codebase behind a uniform abstraction.</span></span>

<span data-ttu-id="a306c-232">Omdat het is gebouwd op basis van Power shell Standard, vereist PSES een runtime-implementatie van Power shell om correct te kunnen worden getest.</span><span class="sxs-lookup"><span data-stu-id="a306c-232">Because it is built against PowerShell Standard, PSES requires a runtime implementation of PowerShell in order to be tested correctly.</span></span> <span data-ttu-id="a306c-233">Om dit te doen, nemen [de xUnit-tests van PSES][] door `Microsoft.PowerShell.SDK` en om `Microsoft.PowerShell.5.ReferenceAssemblies` een Power shell-implementatie in de test omgeving te bieden.</span><span class="sxs-lookup"><span data-stu-id="a306c-233">To do this, [PSES's xUnit][] tests pull in `Microsoft.PowerShell.SDK` and `Microsoft.PowerShell.5.ReferenceAssemblies` in order to provide a PowerShell implementation in the test environment.</span></span>

<span data-ttu-id="a306c-234">Net als bij PSReadLine biedt PSES geen ondersteuning voor .NET 4,6 en lager, maar wordt er tijdens runtime [een controle uitgevoerd][] voordat een van de api's wordt aangeroepen die een crash ondervindt in de lagere .NET Framework Runtimes.</span><span class="sxs-lookup"><span data-stu-id="a306c-234">As with PSReadLine, PSES cannot support .NET 4.6 and below, but it [performs a check][] at runtime before calling any of the APIs that could cause a crash on the lower .NET Framework runtimes.</span></span>

### <a name="psscriptanalyzer"></a><span data-ttu-id="a306c-235">PSScriptAnalyzer</span><span class="sxs-lookup"><span data-stu-id="a306c-235">PSScriptAnalyzer</span></span>

<span data-ttu-id="a306c-236">[PSScriptAnalyzer][], de pluisie voor Power shell, moet doel syntactische elementen zijn die alleen in bepaalde versies van Power shell zijn geïntroduceerd.</span><span class="sxs-lookup"><span data-stu-id="a306c-236">[PSScriptAnalyzer][], the linter for PowerShell, must target syntactic elements only introduced in certain versions of PowerShell.</span></span> <span data-ttu-id="a306c-237">Omdat herkenning van deze syntactische elementen wordt uitgevoerd door een [AstVisitor2][]te implementeren, is het niet mogelijk om PowerShellStandard te gebruiken en ook AST-methoden te implementeren voor nieuwere Power shell-syntaxis.</span><span class="sxs-lookup"><span data-stu-id="a306c-237">Because recognition of these syntactic elements is accomplished by implementing an [AstVisitor2][], it's not possible to use PowerShellStandard and also implement AST visitor methods for newer PowerShell syntaxes.</span></span>

<span data-ttu-id="a306c-238">In plaats daarvan [bedoelt PSScriptAnalyzer elke Power shell-versie][] als een bouw configuratie en produceert deze een afzonderlijke dll voor elk van deze versies.</span><span class="sxs-lookup"><span data-stu-id="a306c-238">Instead, PSScriptAnalyzer [targets each PowerShell version][] as a build configuration, and produces a separate DLL for each of them.</span></span> <span data-ttu-id="a306c-239">Dit verhoogt de bouw grootte en complexiteit, maar maakt het volgende mogelijk:</span><span class="sxs-lookup"><span data-stu-id="a306c-239">This increases build size and complexity, but allows:</span></span>

- <span data-ttu-id="a306c-240">Versie-specifieke API-doel items</span><span class="sxs-lookup"><span data-stu-id="a306c-240">Version-specific API targeting</span></span>
- <span data-ttu-id="a306c-241">Versie-specifieke functionaliteit die moet worden geïmplementeerd zonder dat er runtime kosten in rekening worden gebracht</span><span class="sxs-lookup"><span data-stu-id="a306c-241">Version-specific functionality to be implemented with essentially no runtime cost</span></span>
- <span data-ttu-id="a306c-242">Het totale aantal ondersteuning voor Windows Power shell is helemaal naar .NET Framework 4.5.2</span><span class="sxs-lookup"><span data-stu-id="a306c-242">Total support for Windows PowerShell all the way down to .NET Framework 4.5.2</span></span>

## <a name="summary"></a><span data-ttu-id="a306c-243">Samenvatting</span><span class="sxs-lookup"><span data-stu-id="a306c-243">Summary</span></span>

<span data-ttu-id="a306c-244">In dit artikel hebben we de NuGet-pakketten die beschikbaar zijn voor het doel van de implementatie van een .NET-project dat Power shell gebruikt, vermeld en besproken, en de redenen voor het gebruik ervan.</span><span class="sxs-lookup"><span data-stu-id="a306c-244">In this article, we've listed and discussed the NuGet packages available to target when implementing a .NET project that uses PowerShell, and the reasons you might have for using one over another.</span></span>

<span data-ttu-id="a306c-245">Als u de samen vatting hebt overgeslagen, zijn er enkele algemene aanbevelingen:</span><span class="sxs-lookup"><span data-stu-id="a306c-245">If you've skipped to the summary, some broad recommendations are:</span></span>

- <span data-ttu-id="a306c-246">Power shell- **modules** moeten worden gecompileerd op basis van Power shell Standard als alleen api's voor verschillende Power shell-versies hoeven te worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="a306c-246">PowerShell **modules** should compile against PowerShell Standard if they only require APIs common to different PowerShell versions.</span></span>
- <span data-ttu-id="a306c-247">Power shell- **hosts en-toepassingen** die Power shell intern moeten uitvoeren, moeten gericht zijn op de Power shell SDK voor Power shell 6 + of de relevante Windows Power shell-referentie-Assembly's voor Windows Power shell.</span><span class="sxs-lookup"><span data-stu-id="a306c-247">PowerShell **hosts and applications** that need to run PowerShell internally should target the PowerShell SDK for PowerShell 6+ or the relevant Windows PowerShell reference assemblies for Windows PowerShell.</span></span>
- <span data-ttu-id="a306c-248">Power shell-modules die **Version-specifieke api's** nodig hebben, moeten zijn gericht op de Power shell SDK of Windows Power shell-referentie-assembly's voor de vereiste Power shell-versies, met behulp van deze als referentie-assembly's (dat wil zeggen, de Power shell-afhankelijkheden niet publiceren</span><span class="sxs-lookup"><span data-stu-id="a306c-248">PowerShell modules that need **version-specific APIs** should target the PowerShell SDK or Windows PowerShell reference assemblies for the required PowerShell versions, using them as reference assemblies (that is, not publishing the PowerShell dependencies).</span></span>

<!--link references -->

[.NET Standard 2,0]: /dotnet/standard/net-standard
[.NET Standard 2.0]: /dotnet/standard/net-standard
[about_Modules]: /powershell/module/microsoft.powershell.core/about/about_modules
[Add-type]: /powershell/module/microsoft.powershell.utility/add-type
[Add-Type]: /powershell/module/microsoft.powershell.utility/add-type
[AstVisitor2]: /dotnet/api/system.management.automation.language.astvisitor2
[CmdletProvider]: /dotnet/api/system.management.automation.provider.cmdletprovider
[CreateDefault2]: /dotnet/api/system.management.automation.runspaces.initialsessionstate.createdefault2
[csproj]: https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/PSReadLine.csproj
[Micro soft. Power shell. SDK]: https://www.nuget.org/packages/Microsoft.PowerShell.SDK/
[Microsoft.PowerShell.SDK]: https://www.nuget.org/packages/Microsoft.PowerShell.SDK/
[Netstandaard. Library]: https://www.nuget.org/packages/NETStandard.Library/
[NETStandard.Library]: https://www.nuget.org/packages/NETStandard.Library/
[NuGet]: https://www.nuget.org/
[Hiermee wordt een controle uitgevoerd]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[performs a check]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[Pester]: https://github.com/Pester/Pester
[Power shell editor-Services]: https://github.com/PowerShell/PowerShellEditorServices/
[PowerShell Editor Services]: https://github.com/PowerShell/PowerShellEditorServices/
[Power shell-uitbrei ding]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[PowerShell extension]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[Power shell-NuGet]: https://www.nuget.org/packages/PowerShell/
[PowerShell NuGet]: https://www.nuget.org/packages/PowerShell/
[Standaard-Power shell-opslag]: https://github.com/PowerShell/PowerShellStandard
[PowerShell Standard repository]: https://github.com/PowerShell/PowerShellStandard
[PowerShellStandard. Library]: https://www.nuget.org/packages/PowerShellStandard.Library/
[PowerShellStandard.Library]: https://www.nuget.org/packages/PowerShellStandard.Library/
[PSCmdlet]: /dotnet/api/system.management.automation.pscmdlet
[XUnit van PSES]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSES's xUnit]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSHost]: /dotnet/api/system.management.automation.host.pshost
[PrivateAssets-kenmerk]: /dotnet/core/tools/csproj#packagereference
[PrivateAssets attribute]: /dotnet/core/tools/csproj#packagereference
[PSReadLine]: https://github.com/PowerShell/PSReadLine
[PSScriptAnalyzer]: https://github.com/powershell/psscriptanalyzer
[Referentie-assembly's]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[reference assemblies]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[Begin taak]: /powershell/module/microsoft.powershell.core/start-job
[Start-Job]: /powershell/module/microsoft.powershell.core/start-job
[System. Management. Automation]: https://www.nuget.org/packages/System.Management.Automation/
[System.Management.Automation]: https://www.nuget.org/packages/System.Management.Automation/
[streeft elke Power shell-versie]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[targets each PowerShell version]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[Dit blog bericht]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[this blog post]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[Visual Studio Code]: https://code.visualstudio.com/
[Windows PowerShell SDK]: /powershell/scripting/developer/windows-powershell
